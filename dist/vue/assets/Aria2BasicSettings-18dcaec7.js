import{d as T,x as R,r as x,c as j,a as q,L as F,E as d,g as G,l,u as p,f as V,v as L,y as $,k as s,e as i,B as H,o as _,m as t,N as J,p as w,A as K,i as Q}from"./index-aa3933e3.js";const W={class:"aria2-basic-settings"},X=T({__name:"Aria2BasicSettings",setup(Y){const r=R(),v=x(),f=x(!1),g=x(!1),M=j(()=>!!window.electronAPI),n=q({dir:"",maxConcurrentDownloads:5,maxConnectionPerServer:5,minSplitSize:"10M",continue:!0,saveSession:!0,saveSessionInterval:60}),D={maxConcurrentDownloads:[{required:!0,message:"请输入最大同时下载数",trigger:"blur"},{type:"number",min:1,max:16,message:"值必须在1-16之间",trigger:"blur"}],maxConnectionPerServer:[{required:!0,message:"请输入每服务器最大连接数",trigger:"blur"},{type:"number",min:1,max:16,message:"值必须在1-16之间",trigger:"blur"}],saveSessionInterval:[{type:"number",min:60,max:3600,message:"值必须在60-3600之间",trigger:"blur"}]};F(()=>{r.isConnected&&y()});async function y(){if(!r.isConnected){d.warning("请先连接到 Aria2 服务器");return}f.value=!0;try{console.log("Loading Aria2 global settings...");const o=await r.getGlobalOptions();if(console.log("Received options:",o),o&&typeof o=="object")n.dir=o.dir||"",n.maxConcurrentDownloads=parseInt(o["max-concurrent-downloads"]||"5"),n.maxConnectionPerServer=parseInt(o["max-connection-per-server"]||"5"),n.minSplitSize=o["min-split-size"]||"10M",n.continue=o.continue==="true"||o.continue===!0,n.saveSession=o["save-session"]!=="false"&&o["save-session"]!==!1,n.saveSessionInterval=parseInt(o["save-session-interval"]||"60"),console.log("Parsed settings:",n),d.success("设置加载成功");else throw new Error("Invalid options format received")}catch(o){const e=o instanceof Error?o.message:"未知错误";d.error(`加载设置失败: ${e}`),console.error("Failed to load settings:",o)}finally{f.value=!1}}async function I(){if(v.value){try{await v.value.validate()}catch{return}if(!r.isConnected){d.warning("请先连接到 Aria2 服务器");return}g.value=!0;try{const o={dir:n.dir,"max-concurrent-downloads":n.maxConcurrentDownloads.toString(),"max-connection-per-server":n.maxConnectionPerServer.toString(),"min-split-size":n.minSplitSize,continue:n.continue.toString(),"save-session":n.saveSession.toString(),"save-session-interval":n.saveSessionInterval.toString()};await r.changeGlobalOptions(o),d.success("设置已保存")}catch(o){d.error("保存设置失败"),console.error("Failed to save settings:",o)}finally{g.value=!1}}}async function A(){try{await K.confirm("确定要恢复为默认设置吗？","确认恢复",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),Object.assign(n,{dir:"",maxConcurrentDownloads:5,maxConnectionPerServer:5,minSplitSize:"10M",continue:!0,saveSession:!0,saveSessionInterval:60}),d.success("已恢复为默认设置")}catch{}}async function P(){if(!window.electronAPI){d.warning("此功能仅在桌面版中可用");return}try{const o=await window.electronAPI.showOpenDialog({properties:["openDirectory"],title:"选择下载目录"});!o.canceled&&o.filePaths.length>0&&(n.dir=o.filePaths[0])}catch{d.error("选择目录失败")}}return(o,e)=>{const B=i("el-alert"),k=i("el-icon"),c=i("el-button"),z=i("el-input"),u=i("el-form-item"),S=i("el-input-number"),m=i("el-option"),E=i("el-select"),b=i("el-card"),C=i("el-switch"),U=i("el-space"),N=i("el-form"),O=H("loading");return _(),G("div",W,[e[21]||(e[21]=l("div",{class:"settings-header"},[l("h2",null,"Aria2 基本设置"),l("p",{class:"settings-description"},"配置 Aria2 的基本下载参数")],-1)),p(r).isConnected?L("",!0):(_(),V(B,{key:0,title:"未连接到 Aria2 服务器",description:"请先连接到 Aria2 服务器才能修改设置",type:"warning",closable:!1,style:{"margin-bottom":"20px"}})),$((_(),V(N,{ref_key:"formRef",ref:v,model:n,rules:D,"label-width":"200px",style:{"max-width":"800px"},disabled:!p(r).isConnected},{default:s(()=>[t(b,{class:"setting-group"},{header:s(()=>[...e[7]||(e[7]=[l("span",{class:"group-title"},"下载设置",-1)])]),default:s(()=>[t(u,{label:"下载目录",prop:"dir"},{default:s(()=>[t(z,{modelValue:n.dir,"onUpdate:modelValue":e[0]||(e[0]=a=>n.dir=a),placeholder:"默认下载目录，如：D:\\Downloads"},{append:s(()=>[t(c,{onClick:P,disabled:!M.value},{default:s(()=>[t(k,null,{default:s(()=>[t(p(J))]),_:1})]),_:1},8,["disabled"])]),_:1},8,["modelValue"]),e[8]||(e[8]=l("div",{class:"form-tip"},"设置新任务的默认保存目录",-1))]),_:1}),t(u,{label:"最大同时下载数",prop:"maxConcurrentDownloads"},{default:s(()=>[t(S,{modelValue:n.maxConcurrentDownloads,"onUpdate:modelValue":e[1]||(e[1]=a=>n.maxConcurrentDownloads=a),min:1,max:16,style:{width:"200px"}},null,8,["modelValue"]),e[9]||(e[9]=l("div",{class:"form-tip"},"同时进行的下载任务数量限制（1-16）",-1))]),_:1}),t(u,{label:"每服务器最大连接数",prop:"maxConnectionPerServer"},{default:s(()=>[t(S,{modelValue:n.maxConnectionPerServer,"onUpdate:modelValue":e[2]||(e[2]=a=>n.maxConnectionPerServer=a),min:1,max:16,style:{width:"200px"}},null,8,["modelValue"]),e[10]||(e[10]=l("div",{class:"form-tip"},"对单个服务器的最大连接数（1-16）",-1))]),_:1}),t(u,{label:"最小分片大小",prop:"minSplitSize"},{default:s(()=>[t(E,{modelValue:n.minSplitSize,"onUpdate:modelValue":e[3]||(e[3]=a=>n.minSplitSize=a),style:{width:"200px"}},{default:s(()=>[t(m,{label:"1M",value:"1M"}),t(m,{label:"5M",value:"5M"}),t(m,{label:"10M",value:"10M"}),t(m,{label:"20M",value:"20M"}),t(m,{label:"50M",value:"50M"}),t(m,{label:"100M",value:"100M"})]),_:1},8,["modelValue"]),e[11]||(e[11]=l("div",{class:"form-tip"},"文件分片下载的最小大小",-1))]),_:1})]),_:1}),t(b,{class:"setting-group"},{header:s(()=>[...e[12]||(e[12]=[l("span",{class:"group-title"},"下载选项",-1)])]),default:s(()=>[t(u,{label:"断点续传",prop:"continue"},{default:s(()=>[t(C,{modelValue:n.continue,"onUpdate:modelValue":e[4]||(e[4]=a=>n.continue=a)},null,8,["modelValue"]),e[13]||(e[13]=l("div",{class:"form-tip"},"支持断点续传的下载任务",-1))]),_:1})]),_:1}),t(b,{class:"setting-group"},{header:s(()=>[...e[14]||(e[14]=[l("span",{class:"group-title"},"其他设置",-1)])]),default:s(()=>[t(u,{label:"自动保存会话",prop:"saveSession"},{default:s(()=>[t(C,{modelValue:n.saveSession,"onUpdate:modelValue":e[5]||(e[5]=a=>n.saveSession=a)},null,8,["modelValue"]),e[15]||(e[15]=l("div",{class:"form-tip"},"定期保存下载会话，重启后可恢复未完成的任务",-1))]),_:1}),t(u,{label:"会话保存间隔",prop:"saveSessionInterval"},{default:s(()=>[t(S,{modelValue:n.saveSessionInterval,"onUpdate:modelValue":e[6]||(e[6]=a=>n.saveSessionInterval=a),min:60,max:3600,disabled:!n.saveSession,style:{width:"200px"}},null,8,["modelValue","disabled"]),e[16]||(e[16]=l("span",{style:{"margin-left":"8px"}},"秒",-1)),e[17]||(e[17]=l("div",{class:"form-tip"},"自动保存会话的时间间隔（60-3600秒）",-1))]),_:1})]),_:1}),t(u,{style:{"margin-top":"24px"}},{default:s(()=>[t(U,null,{default:s(()=>[t(c,{type:"primary",onClick:I,loading:g.value,disabled:!p(r).isConnected},{default:s(()=>[...e[18]||(e[18]=[w(" 保存设置 ",-1)])]),_:1},8,["loading","disabled"]),t(c,{onClick:y,disabled:!p(r).isConnected},{default:s(()=>[...e[19]||(e[19]=[w(" 重新加载 ",-1)])]),_:1},8,["disabled"]),t(c,{onClick:A,disabled:!p(r).isConnected},{default:s(()=>[...e[20]||(e[20]=[w(" 恢复默认 ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model","disabled"])),[[O,f.value]])])}}});const h=Q(X,[["__scopeId","data-v-7aafa959"]]);export{h as default};
